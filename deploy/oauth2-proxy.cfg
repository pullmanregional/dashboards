## OAuth2 Proxy Config File
## https://github.com/oauth2-proxy/oauth2-proxy

## <addr>:<port> to listen on for HTTP/HTTPS clients
http_address = "127.0.0.1:4180"

## Are we running behind a reverse proxy? Will not accept headers like X-Real-Ip unless this is set.
reverse_proxy = true

## the OAuth Redirect URL.
redirect_url = <same as in etc/nginx/oauth2-proxy-endpoints.conf>

## Appearance of login screen
custom_templates_dir = "/home/<dedicated user>/oauth2-proxy-templates"
banner = "-"
footer = "-"
custom_sign_in_logo = "https://www.pullmanregional.org/hubfs/PullmanRegionalHospital_December2019/Image/logo.svg"
provider_display_name = "your organization"

## the http url(s) of the upstream endpoint. If multiple, routing is based on path
# No upstreams configured - nginx handles routing

## Logging configuration - logs output to systemd journal for monitoring
## Enables standard messages, HTTP requests, and authentication events
standard_logging = true
request_logging = true
auth_logging = true

## pass HTTP Basic Auth, X-Forwarded-User and X-Forwarded-Email information to upstream
pass_basic_auth = true
pass_user_headers = true
## pass the request Host Header to upstream
pass_host_header = true

## Additional headers to work with nginx auth_request mode
set_authorization_header=true
pass_authorization_header=true
# Pass OAuth Access token to upstream via "X-Forwarded-Access-Token"
pass_access_token = true
# Set X-Auth-Request-* headers for nginx auth_request module
set_xauthrequest=true

## Email Domains to allow authentication for (this authorizes any email on this domain)
## To authorize any email addresses use "*"
email_domains = ["*"]

## Microsoft Entra ID Provider Configuration
provider = "entra-id"
oidc_issuer_url = "https://login.microsoftonline.com/<TENANT_ID>/v2.0"

## The OAuth Client ID and Secret from Entra ID app config
client_id = <TODO>
client_secret = <TODO>

## OAuth scopes requested: 'openid' enables authentication, 'email' retrieves user email claim
scope = "openid email"

## Verify SSL certificates when connecting to OAuth provider (should always be false in production)
ssl_insecure_skip_verify = false

## Cookie Settings - Authentication session stored in browser cookies
## Expires after 7 days (168h), refreshes hourly, secure flags prevent JavaScript access and require HTTPS
cookie_name = "_oauth2_proxy"
cookie_secret = <generate random secret with: `openssl rand -base64 32`>
cookie_expire = "168h"
cookie_refresh = "1h"
cookie_secure = true
cookie_httponly = true